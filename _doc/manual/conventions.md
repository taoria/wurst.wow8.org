---
title: 代码规范
sections:
- 源码的组织结构
- 命名规则
- 格式化
- 文档注释
- 避免warnings
- 通顺的使用语言特性
---

代码规范描述了一套规则,这些规则不会强制生成errors,但在开发者间作为建议被广泛接受,以生成一致并规范的代码.


### 源码的组织结构

#### 文件结构

你的所有包应该丢进你工程的`wurst/`文件夹里。你可以在这个文件夹内创建任何形式的自定义文件夹结构,因为包不会受到文件夹结构的影响.

文件夹应该用来组织包和文件.

#### 源文件名


如果一个 `.wurst` 文件只包含一个类或者元组（可能包含与之紧密相关的声明）, 则该文件应该与该类或元组同名.如果一个文件包含多个类,元组,或者仅仅是一些顶部声明,那么选个能描述这个文件包含什么内容的名字.多个单词用驼峰命名法.(比如 `ClosureEvents.wurst`).

#### 源文件的组织
我们鼓励把多个声明(类,元组,顶层的函数)放置在同一wurst源文件中的行为,只要这些声明在语义上高度关联.并且文件的长度足够合理(没有超过几百行)

#### 类的布局

通常来说,类的内容以如下顺序保存.
* 成员变量的声明
* 构造函数
* 一般函数声明

不要按字母序来排列函数声明,不要在扩展方法中分离常规函数.作为替代,将相关联的事物放在一起,这样的话如果有人自上而下阅读该类的时候,就能够搞清楚发生了什么.选择一个组织的顺序(要么更高层次的事物优先,或者与之相反),并长久的保持这样的习惯.包的API应该放在文件顶部,并配上一个文档说明,使得其他开发者能开门见山的看到。

将嵌套的类放在使用这些类的代码旁,如果这些类被设计为外部使用的,并且在类(文件?)内部没有被引用.则将他们放置在最后.


#### 实现接口
实现接口的时候,保持接口的成员在实现中的顺序与在接口中声明的顺序一致.(如有需要的话,也可以跟该实现使用的额外私有方法一起散置开,)


#### 重载布局

在一个类中,把相同的重载放在一起


### 命名规则
Wurst和Java的命名规则类似,特别要强调的是:

包名和类名开头大写,并用驼峰命名法
 (MyExamplePackage).

类名开头大写,并用驼峰命名法

元组名开头小写,并用驼峰命名法

函数,属性,局部变量开头小写,用驼峰而非下划线

常量名使用全大写的下划线分割命名法.


#### 选一个好名字

类名和元组名通常应该是名词或者名词组成的短句,以解释这个类或者元组是什么:
`LinkedList`, `InstantDummyCaster`.

函数名通常是动词或者动词短语,以解释这些方法的作用: `add`, `castImmediate`.
该名字应该提示该方法是否修改了对象或返回了一个新对象

名字应该凸显出该实例的目的.所以最好不要用无意义的单词:(Manager, Wrapper etc.)

在用缩写命名的时候,如果缩写仅为两个字符,两个字符都大写 (`IOTaskExecutor`); 更长的话则单单大写首字符(`LzwCompressor`, `Wc3String`).

### 格式化

通常情况下,Wurst遵循JAVA的代码规范.

使用4个空格或者tab来做缩进.不要在同一个文件中混用两者


#### 平行的空格

在二元操作符间添加空格 (`a + b`).

一元操作符不要添加空格(`a++`)

在流程控制的关键词间加一个单一的空格(`if`, `switch`, `for` and `while`) ,并跟着表达式,如果不是为了提升可读性,不要用括号.

函数的调用和声明,在开括号(`就是()`)前不要有空格.

```wurst
function foo(int x)

init
    foo(1)
```

不要在 `(`, `[`之前,或`]`, `)`之后加空格.

不要在 `.` 或 `..` 周围加空格

在注释后跟一个空格 `//`: `// This is a comment`

不要在用来指定参数类型的尖括号周围加空格
`class HashMap<K, V>`

作为通用的规则,避免任何形式的水平排列.将一个标识符重命名为不同的长度不应该影响声明和使用的格式.


#### Lambda 格式

在 lambda 表达式中，应在 `begin` 和 `end` 关键字周围以及分隔参数和主体的箭头周围使用空格。如果一个调用只接受单个 lambda，应尽可能将其放在括号外传递。倾向于将 lambda 参数作为最后一个参数，这样就可以在不使用 `begin` 和 `end` 的情况下编写。

```wurst
list.filter(t -> t > 10)

execute() ->
	hash = hash()
```

### 文档注释 (hot doc)

对于将在自动补全中显示的文档注释（也称为 hot doc），请使用 `/**` 开头，并用 `*/` 结尾。简短的注释可以放在单行上。

`/** 这是一个简短的文档注释。 */`

Wurst 目前不支持 @param 和 @return 标签。相反，您应该将参数和返回值的描述直接整合到文档注释中，并在提到参数的地方添加链接。

### 避免警告

处理编译器为您的代码显示的所有警告。如果您需要忽略一个有意未使用的变量的警告，请在其名称前加上下划线 `_`。

### 通顺地使用语言特性

#### 局部变量声明

倾向于在需要局部变量的地方声明它们，而不是像在 Jass 中那样将它们全部声明在顶部。如果合理，请将声明与首次赋值合并。

#### 类型推断

尽可能使用 `var` 和 `let` 进行类型推断，而不是显式指定类型。

#### 不可变性

倾向于使用不可变数据而非可变数据。如果局部变量和成员在初始化后不再被修改，应始终将其声明为 `let` 而不是 `var`。

#### 循环的使用

倾向于使用高阶函数（`filter`、`map` 等）而非循环。例外：`forEach`（倾向于使用常规的 for 循环，除非 `forEach` 的接收者是可空的，或者 `forEach` 被用作更长调用链的一部分）。

在选择使用包含多个高阶函数的复杂表达式还是使用循环时，请了解每种情况下所执行操作的成本，并考虑性能问题。

### 单元测试

如果功能不太依赖于 wc3 游戏机制，则倾向于使用测试驱动开发。创建小型的、自包含的函数，用 `@Test` 单独注解它们，并给它们一个描述性的名称。
确保您的测试中至少包含一个**断言**以验证其行为。

测试应放置在包的末尾，或者放置在一个以 `Tests` 为后缀的独立包中，该包将被自动补全建议所忽略。代码和测试不应混合在一起。